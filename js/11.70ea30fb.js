(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{1213:function(t,a,e){"use strict";var s=e("e896"),o=e.n(s);o.a},"66e3":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return t.data?e("q-splitter",{scopedSlots:t._u([{key:"before",fn:function(){return[e("q-toolbar",{class:t.$q.dark.isActive?"q-pa-sm bg-dark":"bg-grey-3 q-pa-sm"},[e("q-toolbar-title",{class:t.$q.dark.isActive?"text-white":"label-color"},[t._v("\n        Chamado Nº "),e("strong",[t._v(t._s(t.data.id))])]),e("div",{class:t.$q.dark.isActive?"text-h5 text-white":"label-color text-h5"},[t._v("\n        "+t._s(t.data.titulo)+"\n      ")])],1),[e("div",{staticClass:"row q-pa-sm label-color"},[e("div",{staticClass:"col-3 label-color"},[t._v("Usuário")]),e("div",{staticClass:"col-2 label-color"},[t._v("Data")]),e("div",{staticClass:"col-2 label-color"},[t._v("Categoria")]),e("div",{staticClass:"col-2 label-color"},[t._v("Sub-Categoria")]),e("div",{staticClass:"col-2 label-color"},[t._v("Status")]),e("div",{staticClass:"col-1 label-color"},[t._v("Prioridade")])]),e("div",{staticClass:"q-pa-sm row value-color"},[e("div",{staticClass:"col-3 value-color"},[t._v(t._s(t.data.usuario))]),e("div",{staticClass:"col-2 value-color"},[t._v(t._s(t.data.data))]),e("div",{staticClass:"col-2 value-color"},[t._v(t._s(t.data.categoria))]),e("div",{staticClass:"col-2 value-color"},[t._v(t._s(t.data.subcategoria))]),e("div",{staticClass:"col-2 text-bold"},[e("q-chip",{attrs:{clickable:"",square:"",size:"sm",outline:"",color:t.statusColor()}},[t._v(t._s(t.data.status))])],1),e("div",{staticClass:"col-1 text-bold"},[e("q-chip",{attrs:{square:"",size:"sm",clickable:"",outline:"",color:t.prioridadeColor()}},[t._v(t._s(t.data.prioridade))])],1)]),e("q-separator",{staticClass:"q-mt-sm q-mb-sm"}),e("div",{staticClass:"row q-pa-sm label-color"},[e("div",{staticClass:"col-3 label-color"},[t._v("Técnico")]),e("div",{staticClass:"col-2 label-color"},[t._v("Data Atribuição")]),e("div",{staticClass:"col-2 label-color"},[t._v("Data Aguardando")]),e("div",{staticClass:"col-2 label-color"},[t._v("Data Fechamento")]),"T"===t.user.type?e("div",{staticClass:"col-3 label-color"},[t._v("Avalição")]):t._e()]),e("div",{staticClass:"q-pa-sm row value-color"},[e("div",{staticClass:"col-3 value-color"},[t._v(t._s(t.data.tecnico))]),e("div",{staticClass:"col-2 value-color"},[t._v(t._s(t.data.dataatribuicao))]),e("div",{staticClass:"col-2 value-color"},[t._v(t._s(t.data.dataaguardando))]),e("div",{staticClass:"col-2 value-color"},[t._v(t._s(t.data.datafechamento))]),"T"===t.user.type?e("div",{staticClass:"col-3 value-color"},[t._v("\n          "+t._s(t.data.avaliacao)+"\n          "),t._l(t.data.avaliacao,(function(t,a){return e("q-icon",{key:a,attrs:{color:"warning",name:"fas fa-star"}})}))],2):t._e()]),e("q-separator",{staticClass:"q-mt-sm q-mb-sm"}),e("q-banner",{staticClass:"q-pa-sm",attrs:{rounded:""}},[e("div",{staticClass:"q-pa-sm text-justify text-subtitle2",domProps:{innerHTML:t._s(t.data.chamado)}})]),"FECHADO"!==t.status&&"T"===t.user.type?e("q-separator",{staticClass:"q-mt-sm q-mb-sm"}):t._e(),e("div",{staticStyle:{height:"25px"}}),"FECHADO"!==t.status&&"T"===t.user.type?e("div",{staticClass:"q-pa-md"},[e("div",{staticClass:"q-gutter-y-md"},[e("q-btn-toggle",{staticStyle:{border:"1px solid #027be3"},attrs:{spread:"",rounded:"",unelevated:"","toggle-color":t.statusColor(),"text-color":"black",options:t.optinsButtonTogle},model:{value:t.status,callback:function(a){t.status=a},expression:"status"}})],1)]):t._e(),t.data.files&&t.data.files[0]&&t.data.files[0].name?e("q-separator",{staticClass:"q-mt-sm q-mb-sm"}):t._e(),t.data.files&&t.data.files[0]&&t.data.files[0].name?e("div",{staticClass:"label-color q-pa-md"},[t._v("\n        Anexos:\n        "),t._l(t.data.files,(function(a,s){return e("q-chip",{key:s,attrs:{outline:"",clickable:"",color:"primary",icon:t.inconType(a.name),label:a.name},on:{click:function(e){return t.downloadFile(a)}}})}))],2):t._e(),e("q-separator",{staticClass:"q-mt-sm q-mb-sm"}),"AGUARDANDO FECHAMENTO"===t.status&&t.data.usuario===t.user.name?e("div",{staticClass:"text-center q-pa-sm text-subtitle2 label-color col"},[e("div",[t._v("\n          Seu Ticket foi marcado para ser "),e("strong",[t._v('"Fechado"')]),t._v(", se você concorda\n          com isso por favor avalie seu atendimento para fechar.\n        ")]),e("q-rating",{staticClass:"q-pa-sm",attrs:{size:"3.5em",max:10,color:"grey","color-selected":t.ratingColors},model:{value:t.ratingModel,callback:function(a){t.ratingModel=a},expression:"ratingModel"}})],1):t._e(),t.ratingModel>0&&"AGUARDANDO FECHAMENTO"===t.status?e("div",{staticClass:"text-center"},[e("div",{staticClass:"label-color q-pa-sm"},[t._v('\n          Sua avaliação foi de "'+t._s(t.ratingModel)+'" Estrelas\n        ')]),e("q-btn",{staticClass:"label-color",attrs:{color:"color1","no-caps":"",rounded:""},on:{click:t.alterStatusFechado}},[t._v("Confirmar")])],1):t._e(),e("div",{staticStyle:{height:"80px"}}),e("div",{staticClass:"q-pa-md q-gutter-sm"},[e("q-btn",{staticClass:"bg-color1 text-white",attrs:{size:"md",to:"/history/ticket/general",align:"between","no-caps":"",icon:"fas fa-chevron-left",label:"Voltar"}},[e("q-tooltip",{attrs:{"transition-show":"rotate","transition-hide":"rotate","content-class":"bg-accent"}},[t._v("Voltar para a Lista de Chamados")])],1),e("q-btn",{staticClass:"bg-color1 text-white",attrs:{size:"md",icon:"fas fa-print","no-caps":"",label:"Imprimir"},on:{click:t.print}},[e("q-tooltip",{attrs:{"transition-show":"rotate","transition-hide":"rotate","content-class":"bg-accent"}},[t._v("Imprimir este Chamado")])],1),e("q-btn",{staticClass:"bg-color1 text-white",attrs:{disable:!1,size:"md",icon:"fas fa-history","no-caps":"",to:t.goTimeLine(),label:"Time Line"}},[e("q-tooltip",{attrs:{"transition-show":"rotate","transition-hide":"rotate","content-class":"bg-accent"}},[t._v("Ir Para Time Line")])],1)],1),t.data?t._e():[e("div",[e("q-banner",{staticClass:"shadow-2"},[e("div",{staticClass:"text-bold label-color"},[e("q-icon",{attrs:{name:"fas fa-info"}}),t._v("  Registro não encontrado\n            ")],1)])],1)]]]},proxy:!0},{key:"after",fn:function(){return[e("div",{staticClass:"position-relative bg-grey-3",style:t.style},[e("q-layout",{class:t.$q.dark.isActive?"bg-dark":"bg-grey-3",attrs:{container:""}},[e("q-header",{attrs:{elevated:""}},[e("q-toolbar",{class:t.$q.dark.isActive?"bg-dark text-white":"bg-grey-3 text-black label-color"},[e("q-btn",{attrs:{round:"",flat:""}},[e("q-icon",{attrs:{name:"fas fa-clipboard-list"}})],1),e("span",{staticClass:"q-pl-md"},[t._v(" Trâmites ")])],1),e("q-separator",{class:(t.$q.dark.isActive,"bg-grey-4")}),0!==t.tramites.length?e("div",{class:t.$q.dark.isActive?"bg-dark text-white":"bg-grey-3 text-black",style:t.style},[t.tramites?e("q-scroll-area",{ref:"scrollArea",style:t.styleRolaPage,attrs:{"thumb-style":t.thumbStyle,"bar-style":t.barStyle}},t._l(t.tramites,(function(a){return e("q-chat-message",{key:a.id,attrs:{name:a.funcionario,avatar:"https://cdn.quasar.dev/img/boy-avatar.png",text:[a.tramite],stamp:a.data,sent:t.user.id===a.funcionarioId,"bg-color":t.colorBalaoChat(a.funcionarioId)}})})),1):t._e()],1):e("div",[e("q-banner",{staticClass:"shadow-2"},[e("div",{staticClass:"text-bold label-color text-center"},[e("q-icon",{attrs:{name:"fas fa-info"}}),t._v("  Sem trâmites ainda...\n              ")],1)])],1)],1),e("q-footer",[e("q-toolbar",{class:t.$q.dark.isActive?"row bg-dark text-white":"bg-grey-3 text-black row"},[e("q-input",{class:t.$q.dark.isActive?"bg-dark text-black col-grow q-mr-sm":"col-grow q-mr-sm",attrs:{rounded:"",disable:"FECHADO"===t.status,outlined:"",dense:"",color:t.$q.dark.isActive?"white":"black",placeholder:"Digite sua mensagem aqui"},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.sendMessage(a)}},model:{value:t.message,callback:function(a){t.message=a},expression:"message"}})],1)],1)],1)],1)]},proxy:!0}],null,!1,1280327576),model:{value:t.splitterModel,callback:function(a){t.splitterModel=a},expression:"splitterModel"}}):t._e()},o=[],i=(e("7f7f"),e("4917"),e("a34a")),r=e.n(i),l=(e("96cf"),e("c973")),n=e.n(l),c=e("9962"),d=e("5299"),u={name:"DetailTicket",computed:{style:function(){return{height:this.$q.screen.height-110+"px"}},styleRolaPage:function(){return{height:this.$q.screen.height-220+"px"}},styleActions:function(){return{height:this.$q.screen.height-900+"px"}},user:function(){return c["a"].getUserFromLocalStorage()},optinsButtonTogle:function(){var t=[{label:"Aberto",value:"ABERTO"},{label:"Andamento",value:"ANDAMENTO"},{label:"Aguardando Fechamento",value:"AGUARDANDO FECHAMENTO"}];return t}},data:function(){return{data:[],splitterModel:70,leftDrawerOpen:!1,status:null,position:0,ratingModel:0,ratingColors:["light-green-2","light-green-3","light-green-4","light-green-5","light-green-6","light-green-7","light-green-8","light-green-9","light-green-10","green-10"],search:"",message:"",thumbStyle:{right:"4px",borderRadius:"5px",backgroundColor:"#027be3",width:"5px",opacity:.75},barStyle:{right:"2px",borderRadius:"9px",backgroundColor:"#027be3",width:"9px",opacity:.2},tramites:[]}},methods:{pesquisar:function(){var t=this;return n()(r.a.mark((function a(){var e,s,o;return r.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e=t.$route.params.id,a.prev=1,!e){a.next=9;break}return a.next=5,t.$axios.get("/view/ticket/detail/".concat(e));case 5:s=a.sent,t.data=s.data.result[0],t.status=s.data.result[0].status,t.tramites=s.data.tramite;case 9:a.next=15;break;case 11:a.prev=11,a.t0=a["catch"](1),o=a.t0.response?a.t0.response.data.message:"Sem comucação com servidor",t.exibirMensagem(o);case 15:case"end":return a.stop()}}),a,null,[[1,11]])})))()},statusColor:function(){var t="primary",a=this.data.status;return"FECHADO"===a?t="blue-6":"ABERTO"===a?t="positive":"ANDAMENTO"===a?t="warning":"AGUARDANDO FECHAMENTO"===a&&(t="grey"),t},exibirMensagem:function(t){this.$q.dialog({component:d["a"],message:t,html:!0,title:"Erro"})},prioridadeColor:function(){var t="primary",a=this.data.prioridade;return"ALTA"===a?t="info":"MÉDIA"===a?t="secondary":"CRÍTICO"===a?t="negative":"BAIXA"===a&&(t="grey"),t},sendMessage:function(){var t=this;if(this.message.length){var a={},e=this.$route.params.id;a.tramite=this.message,a.codigochamado=e;var s="/ticket/tramite";this.$axios.post(s,a).then((function(a){t.pesquisar(),t.message="",t.rolar()}))}},rolar:function(){!this.$q.screen.lt.sm&&this.$refs.scrollArea&&(this.$refs.scrollArea.setScrollPosition(this.position),this.position=2e3*Math.floor(5e6*Math.random()))},colorBalaoChat:function(t){var a="primary";return t===this.user.id&&!0!==this.$q.dark.isActive?a="cyan":t!==this.user.id&&!0!==this.$q.dark.isActive?a="green-5":t===this.user.id&&!0===this.$q.dark.isActive?a="grey":t!==this.user.id&&!0===this.$q.dark.isActive&&(a="blue-grey"),a},alterStatus:function(){var t=this;return n()(r.a.mark((function a(){var e,s,o;return r.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e=t.data.id,s={},o="/alter-ticket/status/".concat(e),t.status===t.data.status){a.next=11;break}return s.status=t.status,a.next=7,t.$axios.put(o,{newStatus:s});case 7:a.sent,t.$q.notify({message:"Status Alterado com sucesso!!",type:"positive",position:"center",progress:!0,timeout:2e3}),t.pesquisar(),c["a"].getUserFromLocalStorage();case 11:case"end":return a.stop()}}),a)})))()},alterStatusFechado:function(){var t=this;return n()(r.a.mark((function a(){var e,s,o;return r.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e=t.data.id,s={},o="/alter-ticket/status/".concat(e),"AGUARDANDO FECHAMENTO"!==t.status){a.next=11;break}return s.status="FECHADO",s.avaliacao=t.ratingModel,a.next=8,t.$axios.put(o,{newStatus:s});case 8:a.sent,t.$q.notify({message:"Status Fechado com sucesso!!",type:"positive",position:"center",progress:!0,timeout:2e3}),t.pesquisar();case 11:case"end":return a.stop()}}),a)})))()},inconType:function(t){console.log(t);var a="";return t.match(".pdf")?(a="far fa-file-pdf",a):t.match(".flv")||t.match(".mp4")||t.match(".mkv")?void(a="far fa-file-video"):t.match(".xls")||t.match(".csv")||t.match(".xlsx")?(a="far fa-file-excel",a):t.match(".jpg")||t.match(".png")||t.match(".jpe")?(a="far fa-file-image",a):t.match(".doc")?(a="fas fa-file-word",a):t.match(".rar")||t.match(".zip")?(a="far fa-file-archive",a):(a="far fa-file-alt",a)},downloadFile:function(t){var a=this;this.$q.loading.show({message:'\n          <span class="text-black text-bold">Por Favor <b>Aguarde</b> estou indo buscar o arquivo.<br/></span>\n          <span class="text-yellow text-bold">Só vai levar um minutinho...</span>\n          ',backgroundColor:"cyan"});var e="/upload-files";this.$axios.get(e,{params:{file:t},responseType:"arraybuffer"}).then((function(e){var s=new Blob([e.data],{type:t.type}),o=window.URL.createObjectURL(s),i=document.createElement("a");i.href=o,i.setAttribute("download",t.name),document.body.appendChild(i),i.click(),a.$q.loading.hide()})).catch((function(t){a.$q.loading.hide();var e=404===t.response.status?t.retorno="Arquivo não encontrado ou inexistente.":"Sem comucação com servidor";a.exibirMensagem(e)}))},print:function(){var t=this;this.$q.loading.show({message:'\n          <span class="text-black text-bold">Por Favor <b>Aguarde</b> montando impressão.<br/></span>\n          <span class="text-yellow text-bold">Só vai levar um minutinho...</span>\n          ',backgroundColor:"cyan"});var a=this.$route.params.id,e="/reports/ticket/".concat(a);this.$axios.get(e,{responseType:"arraybuffer"}).then((function(a){var e=new Blob([a.data],{type:"application/pdf"}),s=window.URL.createObjectURL(e);window.open(s),t.$q.loading.hide()})).catch((function(a){t.$q.loading.hide(),t.$messages.notify(a)}))},goTimeLine:function(){var t=this.$route.params.id,a="timeline/".concat(t);return a}},mounted:function(){this.pesquisar(),this.rolar()},watch:{status:function(){"FECHADO"!==this.status&&this.alterStatus()}}},m=u,p=(e("1213"),e("2877")),v=e("8562"),h=e("65c6"),g=e("6ac5"),b=e("b047"),f=e("eb85"),q=e("0016"),C=e("54e1"),x=e("6a67"),y=e("daf4"),k=e("9c40"),_=e("05c0"),A=e("4d5a"),w=e("e359"),$=e("4983"),T=e("8169"),S=e("7ff0"),M=e("27f9"),D=e("eebe"),O=e.n(D),E=Object(p["a"])(m,s,o,!1,null,"0190f611",null);a["default"]=E.exports;O()(E,"components",{QSplitter:v["a"],QToolbar:h["a"],QToolbarTitle:g["a"],QChip:b["a"],QSeparator:f["a"],QIcon:q["a"],QBanner:C["a"],QBtnToggle:x["a"],QRating:y["a"],QBtn:k["a"],QTooltip:_["a"],QLayout:A["a"],QHeader:w["a"],QScrollArea:$["a"],QChatMessage:T["a"],QFooter:S["a"],QInput:M["a"]})},e896:function(t,a,e){}}]);